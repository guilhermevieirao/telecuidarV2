<div class="jitsi-video-wrapper" [class.dark-theme]="isDarkTheme">
  <!-- Loading State -->
  <div class="loading-overlay" *ngIf="isLoading">
    <div class="loading-content">
      <div class="spinner"></div>
      <p>Conectando à videochamada...</p>
    </div>
  </div>

  <!-- Error State -->
  <div class="error-overlay" *ngIf="errorMessage && !isLoading">
    <div class="error-content">
      <app-icon name="alert-circle" [size]="48" />
      <h3>Erro na Videochamada</h3>
      <p>{{ errorMessage }}</p>
      <app-button variant="primary" (click)="retry()">
        <app-icon name="refresh-cw" [size]="18" />
        Tentar Novamente
      </app-button>
    </div>
  </div>

  <!-- Jitsi Container -->
  <div 
    #jitsiContainer
    id="jitsi-meet-container"
    class="jitsi-container"
    [class.hidden]="isLoading || errorMessage">
  </div>

  <!-- Custom Controls Overlay (opcional) -->
  <div class="custom-controls" *ngIf="showControls && isConnected && !errorMessage">
    <!-- Status Bar -->
    <div class="status-bar">
      <div class="connection-status" [class.connected]="isConnected">
        <span class="status-dot"></span>
        <span>{{ isConnected ? 'Conectado' : 'Desconectado' }}</span>
      </div>
      <div class="participant-count" *ngIf="participantCount > 0">
        <app-icon name="users" [size]="14" />
        <span>{{ participantCount }} participante{{ participantCount !== 1 ? 's' : '' }}</span>
      </div>
      <div class="moderator-badge" *ngIf="isModerator">
        <app-icon name="shield" [size]="14" />
        <span>Moderador</span>
      </div>
    </div>

    <!-- Quick Controls (complementar aos controles do Jitsi) -->
    <div class="quick-controls">
      <button 
        class="control-btn" 
        [class.active]="isMuted"
        (click)="toggleMute()"
        [title]="isMuted ? 'Ativar microfone' : 'Desativar microfone'">
        <app-icon [name]="isMuted ? 'mic-off' : 'mic'" [size]="20" />
      </button>
      
      <button 
        class="control-btn" 
        [class.active]="isVideoOff"
        (click)="toggleVideo()"
        [title]="isVideoOff ? 'Ativar câmera' : 'Desativar câmera'">
        <app-icon [name]="isVideoOff ? 'video-off' : 'video'" [size]="20" />
      </button>
      
      <button 
        class="control-btn" 
        [class.active]="isScreenSharing"
        (click)="toggleScreenShare()"
        title="Compartilhar tela">
        <app-icon name="monitor" [size]="20" />
      </button>
      
      <button 
        class="control-btn"
        (click)="openChat()"
        title="Chat">
        <app-icon name="message-circle" [size]="20" />
      </button>

      <button 
        class="control-btn moderator-only" 
        *ngIf="isModerator"
        (click)="muteAll()"
        title="Silenciar todos">
        <app-icon name="volume-x" [size]="20" />
      </button>
      
      <button 
        class="control-btn danger"
        (click)="hangup()"
        title="Encerrar chamada">
        <app-icon name="phone-off" [size]="20" />
      </button>
    </div>
  </div>
</div>
