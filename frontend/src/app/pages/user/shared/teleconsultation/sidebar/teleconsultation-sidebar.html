<div class="tele-sidebar" [class.open]="isOpen" [class.full-screen]="isFullScreen" [class.with-header]="isHeaderVisible">
  <div class="sidebar-header">
    <div class="sidebar-actions">
      @if (userrole !== 'PATIENT') {
        <button 
          class="icon-btn dictation-btn" 
          [class.active]="isDictationActive"
          [class.listening]="isListening"
          (click)="toggleDictation()" 
          title="Modo Ditado">
          <app-icon [name]="isDictationActive ? 'mic' : 'mic-off'" [size]="20" />
        </button>
      }
      <button class="icon-btn resize-btn" (click)="onToggleMode()" [title]="isFullScreen ? 'Modo Lateral' : 'Tela Cheia'">
        <app-icon [name]="isFullScreen ? 'minus' : 'plus'" [size]="20" />
      </button>
      <button class="icon-btn close-btn" (click)="onToggle()">
        <app-icon name="close" [size]="20" />
      </button>
    </div>
  </div>

  <div class="sidebar-tabs">
    <button 
      *ngFor="let tab of tabs" 
      class="tab-btn" 
      [class.active]="activeTab === tab"
      (click)="onTabChange(tab)">
      {{ tab }}
    </button>
  </div>

  <div class="sidebar-content">
    <!-- Dados do Paciente -->
    <div class="tab-content" *ngIf="activeTab === 'Dados do Paciente'">
      <app-patient-data-tab
        [appointmentId]="appointmentId"
        [appointment]="appointment">
      </app-patient-data-tab>
    </div>

    <!-- Dados da Pré Consulta -->
    <div class="tab-content" *ngIf="activeTab === 'Dados da Pré Consulta'">
      <app-pre-consultation-data-tab
        [appointment]="appointment">
      </app-pre-consultation-data-tab>
    </div>

    <!-- Anamnese -->
    <div class="tab-content" *ngIf="activeTab === 'Anamnese'">
      <app-anamnesis-tab
        [appointmentId]="appointmentId">
      </app-anamnesis-tab>
    </div>

    <!-- Campos da Especialidade -->
    <div class="tab-content" *ngIf="activeTab === 'Campos da Especialidade'">
      <app-specialty-fields-tab
        [appointment]="appointment"
        [appointmentId]="appointmentId">
      </app-specialty-fields-tab>
    </div>

    <!-- IOT -->
    <div class="tab-content" *ngIf="activeTab === 'IOT'">
      <app-iot-tab
        [appointmentId]="appointmentId"
        [userrole]="userrole">
      </app-iot-tab>
    </div>

    <!-- Biométricos -->
    <div class="tab-content" *ngIf="activeTab === 'Biométricos'">
      <app-biometrics-tab 
        [appointmentId]="appointmentId" 
        [userrole]="userrole">
      </app-biometrics-tab>
    </div>

    <!-- Chat Anexos -->
    <div class="tab-content" *ngIf="activeTab === 'Chat Anexos'" style="height: 100%">
      <app-attachments-chat-tab
        [appointmentId]="appointmentId"
        [userrole]="userrole">
      </app-attachments-chat-tab>
    </div>

    <!-- SOAP -->
    <div class="tab-content" *ngIf="activeTab === 'SOAP'">
      <app-soap-tab
        [appointmentId]="appointmentId"
        [userrole]="userrole">
      </app-soap-tab>
    </div>

    <!-- IA -->
    <div class="tab-content" *ngIf="activeTab === 'IA'" style="height: 100%">
      <app-ai-tab
        [appointmentId]="appointmentId"
        [appointment]="appointment"
        [userrole]="userrole">
      </app-ai-tab>
    </div>

    <!-- CADSUS -->
    <div class="tab-content" *ngIf="activeTab === 'CADSUS'" style="height: 100%">
      <app-cadsus-tab
        [appointmentId]="appointmentId"
        [appointment]="appointment">
      </app-cadsus-tab>
    </div>

    <!-- Concluir -->
    <div class="tab-content" *ngIf="activeTab === 'Concluir'" style="height: 100%">
      <app-conclusion-tab
        [appointment]="appointment"
        (finish)="onFinishConsultation($event)">
      </app-conclusion-tab>
    </div>
  </div>
</div>
